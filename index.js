var _0xa520=["\x63\x6F\x6E\x66\x69\x67","\x64\x6F\x74\x65\x6E\x76","\x6D\x6F\x6D\x65\x6E\x74","\x66\x73","\x45\x78\x70\x6F\x72\x74\x54\x6F\x43\x73\x76","\x65\x78\x70\x6F\x72\x74\x2D\x74\x6F\x2D\x63\x73\x76","\x6D\x6F\x6E\x67\x6F\x6F\x73\x65","\x6D\x73\x73\x71\x6C","\x2E\x2F\x6D\x6F\x64\x65\x6C\x73\x2F\x72\x61\x77\x64\x61\x74\x61\x2E\x6D\x6F\x64\x65\x6C","\x2E\x2F\x6D\x6F\x64\x65\x6C\x73\x2F\x63\x61\x6C\x63\x64\x61\x74\x61\x2E\x6D\x6F\x64\x65\x6C","\x65\x6E\x76","\x63\x6F\x6E\x6E\x65\x63\x74","\x75\x73\x65\x46\x69\x6E\x64\x41\x6E\x64\x4D\x6F\x64\x69\x66\x79","\x73\x65\x74","\x2E\x2F\x63\x6F\x6E\x66\x69\x67\x2F\x73\x71\x6C\x2E\x6A\x73","\x6E\x6F\x64\x65\x2D\x6F\x70\x63\x75\x61\x2D\x63\x6C\x69\x65\x6E\x74","\x46\x4C\x45\x58\x59\x5F\x4E\x61\x6D\x65\x73\x70\x61\x63\x65","\x73\x69\x74\x65\x5F\x69\x64","\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65","\x75\x73\x65\x72\x2F\x65\x64\x69\x74\x2E\x74\x78\x74","\x72\x65\x61\x64\x46\x69\x6C\x65\x53\x79\x6E\x63","\x70\x61\x72\x73\x65","\x76\x61\x6C\x75\x65","\x64\x61\x74\x61","\x74\x69\x65\x72\x31","\x74\x69\x65\x72\x32","\x61\x76\x72\x54\x69\x65\x72\x31","\x61\x76\x72\x54\x69\x65\x72\x32","\x75\x73\x65\x72\x20\x6D\x6F\x64\x69\x66\x69\x65\x64\x20","\x6C\x6F\x67","\x7B\x22\x74\x69\x65\x72\x31\x22\x3A\x20\x30\x2C\x20\x22\x74\x69\x65\x72\x32\x22\x3A\x20\x30\x2C\x20\x22\x61\x76\x72\x54\x69\x65\x72\x31\x22\x3A\x20\x30\x2C\x20\x22\x61\x76\x72\x54\x69\x65\x72\x32\x22\x3A\x30\x20\x7D","\x77\x72\x69\x74\x65\x46\x69\x6C\x65\x53\x79\x6E\x63","\x75\x73\x65\x72\x20\x6D\x6F\x64\x69\x66\x69\x65\x64","\x6D\x69\x6E\x75\x74\x65\x73","\x73\x75\x62\x74\x72\x61\x63\x74","\x75\x70\x64\x61\x74\x65\x4D\x61\x6E\x79","\x69\x6E\x73\x65\x72\x74\x4D\x61\x6E\x79","\x73\x74\x72\x69\x6E\x67\x69\x66\x79","\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74","\x6E\x6F\x74\x65","","\x59\x59\x59\x59\x2D\x4D\x4D\x2D\x44\x44\x20\x48\x48\x3A\x6D\x6D\x3A\x73\x73","\x66\x6F\x72\x6D\x61\x74","\x4D\x59\x39\x39\x39\x39\x35\x32\x3A\x4D\x45\x54\x54\x55\x42\x45\x2E\x46\x51\x2D\x47\x4E\x32\x31","\x4D\x59\x39\x39\x39\x39\x35\x32\x3A\x4D\x45\x54\x54\x55\x42\x45\x2E\x46\x51\x2D\x47\x4E\x32\x32","\x4D\x59\x39\x39\x39\x39\x35\x32\x3A\x4D\x45\x54\x54\x55\x42\x45\x2E\x46\x54\x2D\x47\x4E\x32\x31","\x4D\x59\x39\x39\x39\x39\x35\x32\x3A\x4D\x45\x54\x54\x55\x42\x45\x2E\x50\x54\x2D\x47\x4E\x32\x31","\x4D\x59\x39\x39\x39\x39\x35\x32\x3A\x4D\x45\x54\x54\x55\x42\x45\x2E\x54\x54\x2D\x47\x4E\x32\x31","\x4D\x59\x39\x39\x39\x39\x35\x32\x3A\x4D\x45\x54\x54\x55\x42\x45\x2E\x43\x4F\x4D\x4D\x55\x4E\x49\x43\x41\x54\x49\x4F\x4E","\x45\x72\x72\x6F\x72\x20\x73\x61\x76\x65\x20\x64\x61\x74\x61\x20\x74\x6F\x20\x4C\x6F\x63\x61\x6C\x20\x64\x61\x74\x61","\x66\x69\x6E\x64","\x63\x6F\x75\x6E\x74\x44\x6F\x63\x75\x6D\x65\x6E\x74\x73","\x69\x6E\x66\x6F\x72\x6D\x61\x74\x69\x6F\x6E","\x66\x6F\x72\x45\x61\x63\x68","\x61\x76\x72\x46\x6C\x6F\x77","\x61\x76\x72\x5F\x66\x6C\x6F\x77","\x64\x61\x79\x73","\x64\x65\x6C\x65\x74\x65\x4D\x61\x6E\x79","\x44\x65\x6C\x65\x74\x65\x64\x20\x64\x61\x74\x61\x20\x62\x65\x66\x6F\x72\x65\x20","\x54\x6F\x74\x61\x6C\x20\x72\x65\x63\x6F\x72\x64\x20\x64\x65\x6C\x65\x74\x65\x64\x20\x3D\x20","\x64\x65\x6C\x65\x74\x65\x64\x43\x6F\x75\x6E\x74","\x46\x4C\x45\x58\x59\x5F\x54\x61\x67\x6E\x61\x6D\x65\x31","\x46\x4C\x45\x58\x59\x5F\x54\x61\x67\x6E\x61\x6D\x65\x32","\x46\x4C\x45\x58\x59\x5F\x54\x61\x67\x6E\x61\x6D\x65\x33","\x46\x4C\x45\x58\x59\x5F\x54\x61\x67\x6E\x61\x6D\x65\x34","\x46\x4C\x45\x58\x59\x5F\x54\x61\x67\x6E\x61\x6D\x65\x35","\x6C\x6F\x63\x61\x6C","\x70\x75\x73\x68","\x69\x70","\x70\x6F\x72\x74","\x4F\x50\x43\x5F\x53\x45\x52\x56\x45\x52\x5F\x55\x53\x45\x52\x4E\x41\x4D\x45","\x4F\x50\x43\x5F\x53\x45\x52\x56\x45\x52\x5F\x50\x41\x53\x53\x57\x4F\x52\x44","\x6C\x69\x6D\x69\x74","\x73\x6F\x72\x74","\x66\x69\x6E\x64\x4F\x6E\x65","\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A","\x46\x69\x72\x73\x74\x20\x69\x6E\x69\x74\x69\x61\x6C\x69\x7A\x65\x20","\x69\x6E\x70\x75\x74","\x74\x65\x6D\x70\x65\x72\x61\x74\x75\x72\x65","\x70\x72\x65\x73\x73\x75\x72\x65","\x66\x6C\x6F\x77","\x63\x6F\x6D\x70\x65\x6E\x73\x61\x74\x65\x64\x66\x6C\x6F\x77","\x49\x4E\x53\x45\x52\x54\x20\x49\x4E\x54\x4F\x20\x44\x61\x74\x61\x4C\x6F\x67\x67\x65\x72\x31\x20\x28\x73\x69\x74\x65\x5F\x69\x64\x2C\x20\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65\x2C\x20\x74\x65\x6D\x70\x65\x72\x61\x74\x75\x72\x65\x2C\x20\x70\x72\x65\x73\x73\x75\x72\x65\x2C\x20\x66\x6C\x6F\x77\x2C\x20\x63\x6F\x6D\x70\x65\x6E\x73\x61\x74\x65\x64\x66\x6C\x6F\x77\x2C","\x20\x69\x6E\x66\x6F\x72\x6D\x61\x74\x69\x6F\x6E\x2C\x20\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x2C\x20\x74\x69\x65\x72\x31\x2C\x20\x74\x69\x65\x72\x32\x29\x20\x56\x41\x4C\x55\x45\x53\x20","\x20\x28\x40\x73\x69\x74\x65\x5F\x69\x64\x2C\x40\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65\x2C\x20\x40\x74\x65\x6D\x70\x65\x72\x61\x74\x75\x72\x65\x2C\x40\x70\x72\x65\x73\x73\x75\x72\x65\x2C\x20\x40\x66\x6C\x6F\x77\x2C\x20\x40\x63\x6F\x6D\x70\x65\x6E\x73\x61\x74\x65\x64\x66\x6C\x6F\x77\x2C\x20\x40\x69\x6E\x66\x6F\x72\x6D\x61\x74\x69\x6F\x6E\x2C\x20\x40\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x2C\x20\x40\x74\x69\x65\x72\x31\x2C\x20\x40\x74\x69\x65\x72\x32\x29","\x71\x75\x65\x72\x79","\x49\x4E\x53\x45\x52\x54\x20\x49\x4E\x54\x4F\x20\x44\x61\x74\x61\x4C\x6F\x67\x67\x65\x72\x32\x20\x28\x73\x69\x74\x65\x5F\x69\x64\x2C\x20\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65\x2C\x20\x61\x76\x72\x66\x6C\x6F\x77\x2C\x20\x74\x69\x65\x72\x31\x2C\x20\x74\x69\x65\x72\x32\x2C\x20\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x29\x20\x56\x41\x4C\x55\x45\x53\x20\x28\x40\x73\x69\x74\x65\x5F\x69\x64\x2C\x40\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65\x2C\x20\x40\x61\x76\x72\x46\x6C\x6F\x77\x2C\x20\x40\x74\x69\x65\x72\x31\x2C\x20\x40\x74\x69\x65\x72\x32\x2C\x20\x40\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x29","\x69\x73\x5F\x63\x6F\x6E\x6E\x65\x63\x74","\x49\x4E\x53\x45\x52\x54\x20\x49\x4E\x54\x4F\x20\x44\x61\x74\x61\x4C\x6F\x67\x67\x65\x72\x53\x74\x61\x74\x75\x73\x20\x28\x73\x69\x74\x65\x5F\x69\x64\x2C\x20\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65\x2C\x20\x69\x73\x5F\x63\x6F\x6E\x6E\x65\x63\x74\x2C\x20\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x29\x20\x56\x41\x4C\x55\x45\x53\x20\x28\x40\x73\x69\x74\x65\x5F\x69\x64\x2C\x40\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65\x2C\x20\x40\x69\x73\x5F\x63\x6F\x6E\x6E\x65\x63\x74\x2C\x20\x40\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x29","\x62\x65\x66\x6F\x72\x65\x64\x61\x79","\x44\x45\x4C\x45\x54\x45\x20\x46\x52\x4F\x4D\x20\x44\x61\x74\x61\x4C\x6F\x67\x67\x65\x72\x31\x20\x57\x48\x45\x52\x45\x20\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x20\x3C\x20\x40\x62\x65\x66\x6F\x72\x65\x64\x61\x79","\x44\x45\x4C\x45\x54\x45\x20\x46\x52\x4F\x4D\x20\x44\x61\x74\x61\x4C\x6F\x67\x67\x65\x72\x32\x20\x57\x48\x45\x52\x45\x20\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x20\x3C\x20\x40\x62\x65\x66\x6F\x72\x65\x64\x61\x79","\x44\x45\x4C\x45\x54\x45\x20\x46\x52\x4F\x4D\x20\x44\x61\x74\x61\x4C\x6F\x67\x67\x65\x72\x53\x74\x61\x74\x75\x73\x20\x57\x48\x45\x52\x45\x20\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x20\x3C\x20\x40\x62\x65\x66\x6F\x72\x65\x64\x61\x79","\x44\x65\x6C\x65\x74\x65\x64\x20\x64\x61\x74\x61\x20\x62\x65\x66\x6F\x72\x65\x20\x31\x30\x20\x64\x61\x79\x73","\x65\x72\x72\x6F\x72","\x53\x51\x4C\x20\x68\x61\x73\x20\x69\x73\x73\x75\x65\x20","\x6F\x6E","\x63\x72\x65\x61\x74\x65","\x62\x61\x63\x6B\x6F\x66\x66","\x42\x61\x63\x6B\x6F\x66\x66\x20","\x20\x6E\x65\x78\x74\x20\x61\x74\x74\x65\x6D\x70\x74\x20\x69\x6E\x20","\x6D\x73","\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x5F\x6C\x6F\x73\x74","\x43\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x20\x6C\x6F\x73\x74","\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x5F\x72\x65\x65\x73\x74\x61\x62\x6C\x69\x73\x68\x65\x64","\x43\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x20\x72\x65\x2D\x65\x73\x74\x61\x62\x6C\x69\x73\x68\x65\x64","\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x5F\x66\x61\x69\x6C\x65\x64","\x43\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x20\x66\x61\x69\x6C\x65\x64","\x73\x74\x61\x72\x74\x5F\x72\x65\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E","\x53\x74\x61\x72\x74\x69\x6E\x67\x20\x72\x65\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E","\x61\x66\x74\x65\x72\x5F\x72\x65\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E","\x41\x66\x74\x65\x72\x20\x52\x65\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x20\x65\x76\x65\x6E\x74\x20\x3D\x3E","\x75\x73\x65\x72\x6E\x61\x6D\x65","\x70\x61\x73\x73\x77\x6F\x72\x64","\x63\x72\x65\x61\x74\x65\x53\x65\x73\x73\x69\x6F\x6E","\x63\x72\x65\x61\x74\x65\x53\x75\x62\x73\x63\x72\x69\x70\x74\x69\x6F\x6E\x32","\x73\x74\x61\x72\x74\x65\x64","\x6E\x73\x3D","\x3B\x73\x3D","\x6E\x61\x6D\x65","\x56\x61\x6C\x75\x65","\x69\x6E\x69\x74\x69\x61\x6C\x69\x7A\x65\x64","\x4F\x50\x43\x20\x55\x41\x20\x49\x6E\x69\x74\x69\x61\x6C\x69\x7A\x65\x64\x21\x20\x43\x6F\x6E\x6E\x65\x63\x74\x20\x74\x6F\x20\x46\x6C\x65\x78\x79\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6C\x6C\x79","\x63\x68\x61\x6E\x67\x65\x64","\x6E\x6F\x64\x65\x49\x64","\x69\x74\x65\x6D\x54\x6F\x4D\x6F\x6E\x69\x74\x6F\x72","\x73\x65\x72\x76\x65\x72\x54\x69\x6D\x65\x73\x74\x61\x6D\x70","\x66\x69\x6E\x64\x49\x6E\x64\x65\x78","\x74\x6F\x46\x69\x78\x65\x64","\x74\x69\x6D\x65","\x74\x65\x72\x6D\x69\x6E\x61\x74\x65","\x63\x6C\x6F\x73\x65","\x64\x69\x73\x63\x6F\x6E\x6E\x65\x63\x74","\x44\x6F\x6E\x65\x20\x21","\x45\x72\x72\x6F\x72","\x2C","\x22","\x2E","\x44\x61\x74\x61","\x54\x69\x6D\x65\x53\x74\x61\x6D\x70","\x54\x61\x67\x6E\x61\x6D\x65","\x67\x65\x6E\x65\x72\x61\x74\x65\x43\x73\x76","\x59\x59\x59\x59\x4D\x4D\x44\x44\x5F\x48\x48\x6D\x6D\x73\x73","\x43\x53\x56\x5F\x45\x58\x50\x4F\x52\x54\x5F\x50\x41\x54\x48","\x5C\x44\x61\x74\x61\x5F","\x5F","\x2E\x63\x73\x76"];require(_0xa520[1])[_0xa520[0]]();var moment=require(_0xa520[2]);var fs=require(_0xa520[3]);const ExportToCsv=require(_0xa520[5])[_0xa520[4]];var mongoose=require(_0xa520[6]);var sql=require(_0xa520[7]);var RawData=require(_0xa520[8]);var CalcData=require(_0xa520[9]);mongoose[_0xa520[11]](process[_0xa520[10]].MONGO_URL,{useNewUrlParser:true,useUnifiedTopology:true});mongoose[_0xa520[13]](_0xa520[12],false);const sqlConfig=require(_0xa520[14]);const {OPCUAClient,resolveNodeId,AttributeIds,ClientMonitoredItemGroup,TimestampsToReturn}=require(_0xa520[15]);let TIER_2_BENCHMARK=parseFloat(process[_0xa520[10]].TIER_2_BENCHMARK);let TIME_INTERVAL_GETDATA=parseInt(process[_0xa520[10]].TIME_INTERVAL_GETDATA)* 1000;let TIME_INTERVAL_CALCDATA=parseInt(process[_0xa520[10]].TIME_INTERVAL_CALCDATA)* 1000;let TIME_INTERVAL_REMOVE_DATA=parseInt(process[_0xa520[10]].TIME_INTERVAL_REMOVE_DATA)* 86400000;let flexy_ns=process[_0xa520[10]][_0xa520[16]];var opc_server=[];var opc_server_avr=[];var interval_flag=0;async function run(){ await readFirstConfig(); await setTimeout(function(){},2000); await setInterval(async function(){let _0x7975x12=opc_server[0][_0xa520[17]];let _0x7975x13=opc_server[0][_0xa520[18]];if(interval_flag){const _0x7975x14= await fs[_0xa520[20]](_0xa520[19]);let _0x7975x15=_0x7975x14.toString();let _0x7975x16=JSON[_0xa520[21]](_0x7975x15);let _0x7975x17=opc_server[0][_0xa520[23]][3][_0xa520[22]];let _0x7975x18=opc_server[0][_0xa520[24]];let _0x7975x19=opc_server[0][_0xa520[25]];if(_0x7975x16[_0xa520[24]]> 0|| _0x7975x16[_0xa520[25]]> 0|| _0x7975x16[_0xa520[26]]> 0|| _0x7975x16[_0xa520[27]]> 0){console[_0xa520[29]](_0xa520[28],_0x7975x16[_0xa520[24]],_0x7975x16[_0xa520[25]],_0x7975x16[_0xa520[26]],_0x7975x16[_0xa520[27]]);fs[_0xa520[31]](_0xa520[19],_0xa520[30]);_0x7975x18= _0x7975x16[_0xa520[24]];_0x7975x19= _0x7975x16[_0xa520[25]];let _0x7975x1a={site_id:opc_server[0][_0xa520[17]],site_name:opc_server[0][_0xa520[18]],information:opc_server[0][_0xa520[23]],tier1:_0x7975x16[_0xa520[24]],tier2:_0x7975x16[_0xa520[25]],created_at: new Date(),flag:1,note:_0xa520[32]};let _0x7975x1b=moment()[_0xa520[34]](20,_0xa520[33]);let _0x7975x1c=moment();let _0x7975x1d={created_at:{$gte:_0x7975x1b},tier1:{$gt:0}}; await RawData[_0xa520[35]](_0x7975x1d,{$set:{flag:0}}); await RawData[_0xa520[36]](_0x7975x1a);insert_data(_0x7975x12,_0x7975x13,opc_server[0][_0xa520[23]][0][_0xa520[22]],opc_server[0][_0xa520[23]][2][_0xa520[22]],opc_server[0][_0xa520[23]][1][_0xa520[22]],opc_server[0][_0xa520[23]][3][_0xa520[22]],JSON[_0xa520[37]](opc_server[0][_0xa520[23]]),_0x7975x16[_0xa520[24]],_0x7975x16[_0xa520[25]],opc_server[0][_0xa520[38]]);opc_server_avr[_0xa520[24]]= _0x7975x16[_0xa520[26]];opc_server_avr[_0xa520[25]]= _0x7975x16[_0xa520[27]];opc_server_avr[_0xa520[38]]=  new Date();let _0x7975x1e=opc_server_avr;_0x7975x1e[_0xa520[39]]= _0xa520[32]; await CalcData[_0xa520[36]](_0x7975x1e);_0x7975x1e[_0xa520[39]]= _0xa520[40]};let _0x7975x1f,_0x7975x20;if(_0x7975x17> TIER_2_BENCHMARK){_0x7975x1f= TIER_2_BENCHMARK/ 60+ _0x7975x18;_0x7975x20= (_0x7975x17- TIER_2_BENCHMARK)/ 60+ _0x7975x19}else {_0x7975x1f= _0x7975x17/ 60+ _0x7975x18;_0x7975x20= 0+ _0x7975x19};opc_server[0][_0xa520[24]]= _0x7975x1f;opc_server[0][_0xa520[25]]= _0x7975x20;insert_data(_0x7975x12,_0x7975x13,opc_server[0][_0xa520[23]][0][_0xa520[22]],opc_server[0][_0xa520[23]][2][_0xa520[22]],opc_server[0][_0xa520[23]][1][_0xa520[22]],opc_server[0][_0xa520[23]][3][_0xa520[22]],JSON[_0xa520[37]](opc_server[0][_0xa520[23]]),_0x7975x1f,_0x7975x20,opc_server[0][_0xa520[38]]);let _0x7975x1a={site_id:opc_server[0][_0xa520[17]],site_name:opc_server[0][_0xa520[18]],information:opc_server[0][_0xa520[23]],tier1:opc_server[0][_0xa520[24]],tier2:opc_server[0][_0xa520[25]],created_at: new Date(),flag:1};let _0x7975x21=moment(opc_server[0][_0xa520[38]])[_0xa520[42]](_0xa520[41]);let _0x7975x22=[{TimeStamp:_0x7975x21,Tagname:_0xa520[43],Value:_0x7975x1f},{TimeStamp:_0x7975x21,Tagname:_0xa520[44],Value:_0x7975x20},{TimeStamp:_0x7975x21,Tagname:_0xa520[45],Value:opc_server[0][_0xa520[23]][1][_0xa520[22]]},{TimeStamp:_0x7975x21,Tagname:_0xa520[46],Value:opc_server[0][_0xa520[23]][2][_0xa520[22]]},{TimeStamp:_0x7975x21,Tagname:_0xa520[47],Value:opc_server[0][_0xa520[23]][0][_0xa520[22]]},{TimeStamp:_0x7975x21,Tagname:_0xa520[48],Value:opc_server[0][_0xa520[23]][4][_0xa520[22]]}]; await RawData[_0xa520[36]](_0x7975x1a,function(_0x7975x23,_0x7975x24){if(_0x7975x23){console[_0xa520[29]](_0xa520[49])}})}},TIME_INTERVAL_GETDATA); await setInterval(async function(){if(interval_flag){let _0x7975x1b=moment()[_0xa520[34]](15,_0xa520[33]);let _0x7975x1c=moment();let _0x7975x1d={created_at:{$gte:_0x7975x1b,$lte:_0x7975x1c},tier1:{$gt:0}};let _0x7975x25= await RawData[_0xa520[50]](_0x7975x1d);let _0x7975x26= await RawData[_0xa520[51]](_0x7975x1d);let _0x7975x27=0;_0x7975x25[_0xa520[53]](function(_0x7975x28){_0x7975x27= _0x7975x27+ parseFloat(_0x7975x28[_0xa520[52]][3][_0xa520[22]])});let _0x7975x29=0;if(_0x7975x26> 0){_0x7975x29= _0x7975x27/ _0x7975x26};let _0x7975x2a=opc_server_avr[_0xa520[24]];let _0x7975x2b=opc_server_avr[_0xa520[25]];let _0x7975x2c,_0x7975x2d;if(_0x7975x29> TIER_2_BENCHMARK){_0x7975x2c= TIER_2_BENCHMARK/ 60+ _0x7975x2a;_0x7975x2d= (_0x7975x29- TIER_2_BENCHMARK)/ 60+ _0x7975x2b}else {_0x7975x2c= _0x7975x29/ 60+ _0x7975x2a;_0x7975x2d= 0+ _0x7975x2b};opc_server_avr[_0xa520[24]]= _0x7975x2c;opc_server_avr[_0xa520[25]]= _0x7975x2d;opc_server_avr[_0xa520[38]]=  new Date();opc_server_avr[_0xa520[54]]= _0x7975x29;let _0x7975x2e=opc_server_avr;_0x7975x2e[_0xa520[55]]= opc_server_avr[_0xa520[54]]; await CalcData[_0xa520[36]](_0x7975x2e,function(_0x7975x23,_0x7975x24){if(_0x7975x23){console[_0xa520[29]](_0xa520[49])}}); await saveAvrDataToDatabase(opc_server[0][_0xa520[17]],opc_server[0][_0xa520[18]],opc_server_avr[_0xa520[54]],opc_server_avr[_0xa520[24]],opc_server_avr[_0xa520[25]])}},TIME_INTERVAL_CALCDATA); await setInterval(async function(){let _0x7975x2f=moment()[_0xa520[34]](10,_0xa520[56]);const _0x7975x30= await RawData[_0xa520[57]]({created_at:{$lte:_0x7975x2f}});console[_0xa520[29]](_0xa520[58],_0x7975x2f,_0xa520[59],_0x7975x30[_0xa520[60]]);deleteDataAfter10days()},TIME_INTERVAL_REMOVE_DATA); await setInterval(async function(){saveConnectionStatusToDatabase(opc_server[0][_0xa520[17]],opc_server[0][_0xa520[18]],opc_server[0][_0xa520[23]][4][_0xa520[22]])},TIME_INTERVAL_GETDATA); await setInterval(async function(){},10000); await readOPCUA1()}run();async function readFirstConfig(){let _0x7975x32=[];let _0x7975x33=[process[_0xa520[10]][_0xa520[61]],process[_0xa520[10]][_0xa520[62]],process[_0xa520[10]][_0xa520[63]],process[_0xa520[10]][_0xa520[64]],process[_0xa520[10]][_0xa520[65]]];for(const _0x7975x34 of _0x7975x33){_0x7975x32[_0xa520[67]]({name:_0x7975x34,value:0,time:moment()[_0xa520[66]]()[_0xa520[42]]()})};let _0x7975x35={id:1,site_id:process[_0xa520[10]][_0xa520[17]],site_name:process[_0xa520[10]][_0xa520[18]],ip:process[_0xa520[10]][_0xa520[68]],port:parseInt(process[_0xa520[10]][_0xa520[69]]),username:process[_0xa520[10]][_0xa520[70]],password:process[_0xa520[10]][_0xa520[71]],data:_0x7975x32,tier1:0,tier2:0,created_at: new Date()};opc_server_avr= {avrFlow:0,tier1:0,tier2:0};let _0x7975x36= await RawData[_0xa520[74]]()[_0xa520[73]]({_id:-1})[_0xa520[72]](1);if(_0x7975x36){_0x7975x35[_0xa520[24]]= _0x7975x36[_0xa520[24]];_0x7975x35[_0xa520[25]]= _0x7975x36[_0xa520[25]]}else {_0x7975x35[_0xa520[24]]= parseFloat(process[_0xa520[10]].START_TIER_1);_0x7975x35[_0xa520[25]]= parseFloat(process[_0xa520[10]].START_TIER_2)};let _0x7975x37= await CalcData[_0xa520[74]]()[_0xa520[73]]({_id:-1})[_0xa520[72]](1);if(_0x7975x37){opc_server_avr[_0xa520[24]]= _0x7975x37[_0xa520[24]];opc_server_avr[_0xa520[25]]= _0x7975x37[_0xa520[25]]}else {opc_server_avr[_0xa520[24]]= parseFloat(process[_0xa520[10]].START_AVR_TIER_1);opc_server_avr[_0xa520[25]]= parseFloat(process[_0xa520[10]].START_AVR_TIER_2)};opc_server[_0xa520[67]](_0x7975x35);console[_0xa520[29]](_0xa520[75]);console[_0xa520[29]](_0xa520[76],opc_server,opc_server_avr);return}function insert_data(_0x7975x39,_0x7975x3a,_0x7975x3b,_0x7975x3c,_0x7975x3d,_0x7975x3e,_0x7975x3f,_0x7975x1f,_0x7975x20,_0x7975x40){sql[_0xa520[11]](sqlConfig,function(_0x7975x41){if(_0x7975x41){console[_0xa520[29]](_0x7975x41)}else {var _0x7975x42= new sql.Request();_0x7975x42[_0xa520[77]](_0xa520[17],sql.VarChar,_0x7975x39);_0x7975x42[_0xa520[77]](_0xa520[18],sql.VarChar,_0x7975x3a);_0x7975x42[_0xa520[77]](_0xa520[52],sql.VarChar,_0x7975x3f);_0x7975x42[_0xa520[77]](_0xa520[38],sql.DateTimeOffset,_0x7975x40);_0x7975x42[_0xa520[77]](_0xa520[78],sql.Decimal(10,2),parseFloat(_0x7975x3b+ 0.0));_0x7975x42[_0xa520[77]](_0xa520[79],sql.Decimal(10,2),parseFloat(_0x7975x3c+ 0.0));_0x7975x42[_0xa520[77]](_0xa520[80],sql.Decimal(10,2),parseFloat(_0x7975x3d+ 0.0));_0x7975x42[_0xa520[77]](_0xa520[81],sql.Decimal(10,2),parseFloat(_0x7975x3e+ 0.0));_0x7975x42[_0xa520[77]](_0xa520[24],sql.Decimal(10,2),parseFloat(_0x7975x1f));_0x7975x42[_0xa520[77]](_0xa520[25],sql.Decimal(10,2),parseFloat(_0x7975x20));let _0x7975x43=_0xa520[82]+ _0xa520[83]+ _0xa520[84];_0x7975x42[_0xa520[85]](_0x7975x43,function(_0x7975x41,_0x7975x44){if(_0x7975x41){console[_0xa520[29]](_0x7975x41)}})}})}function saveAvrDataToDatabase(_0x7975x39,_0x7975x3a,_0x7975x46,_0x7975x1f,_0x7975x20){sql[_0xa520[11]](sqlConfig,function(_0x7975x41){if(_0x7975x41){console[_0xa520[29]](_0x7975x41)}else {var _0x7975x42= new sql.Request();_0x7975x42[_0xa520[77]](_0xa520[17],sql.VarChar,_0x7975x39);_0x7975x42[_0xa520[77]](_0xa520[18],sql.VarChar,_0x7975x3a);_0x7975x42[_0xa520[77]](_0xa520[54],sql.Decimal(10,2),parseFloat(_0x7975x46));_0x7975x42[_0xa520[77]](_0xa520[24],sql.Decimal(10,2),parseFloat(_0x7975x1f));_0x7975x42[_0xa520[77]](_0xa520[25],sql.Decimal(10,2),parseFloat(_0x7975x20));_0x7975x42[_0xa520[77]](_0xa520[38],sql.DateTimeOffset, new Date());_0x7975x42[_0xa520[85]](_0xa520[86],function(_0x7975x41,_0x7975x44){if(_0x7975x41){console[_0xa520[29]](_0x7975x41)}})}})}function saveConnectionStatusToDatabase(_0x7975x39,_0x7975x3a,_0x7975x48){sql[_0xa520[11]](sqlConfig,function(_0x7975x41){if(_0x7975x41){console[_0xa520[29]](_0x7975x41)}else {var _0x7975x42= new sql.Request();_0x7975x42[_0xa520[77]](_0xa520[17],sql.VarChar,_0x7975x39);_0x7975x42[_0xa520[77]](_0xa520[18],sql.VarChar,_0x7975x3a);_0x7975x42[_0xa520[77]](_0xa520[87],sql.Bit,_0x7975x48);_0x7975x42[_0xa520[77]](_0xa520[38],sql.DateTimeOffset, new Date());_0x7975x42[_0xa520[85]](_0xa520[88],function(_0x7975x41,_0x7975x44){if(_0x7975x41){console[_0xa520[29]](_0x7975x41)}})}})}function deleteDataAfter10days(){sql[_0xa520[11]](sqlConfig,function(_0x7975x41){if(_0x7975x41){console[_0xa520[29]](_0x7975x41)}else {var _0x7975x42= new sql.Request();let _0x7975x2f=moment()[_0xa520[34]](10,_0xa520[56]);let _0x7975x4a= new Date(_0x7975x2f);_0x7975x42[_0xa520[77]](_0xa520[89],sql.DateTimeOffset,_0x7975x4a);_0x7975x42[_0xa520[85]](_0xa520[90],function(_0x7975x41,_0x7975x44){if(_0x7975x41){console[_0xa520[29]](_0x7975x41)}});_0x7975x42[_0xa520[85]](_0xa520[91],function(_0x7975x41,_0x7975x44){if(_0x7975x41){console[_0xa520[29]](_0x7975x41)}});_0x7975x42[_0xa520[85]](_0xa520[92],function(_0x7975x41,_0x7975x44){if(_0x7975x41){console[_0xa520[29]](_0x7975x41)};console[_0xa520[29]](_0xa520[93])})}});sql[_0xa520[96]](_0xa520[94],(_0x7975x41)=>{console[_0xa520[29]](_0xa520[95],_0x7975x41)})}async function readOPCUA1(){try{const _0x7975x4c={endpoint_must_exist:false};const _0x7975x4d=OPCUAClient[_0xa520[97]](_0x7975x4c);_0x7975x4d[_0xa520[96]](_0xa520[98],(_0x7975x4e,_0x7975x4f)=>{console[_0xa520[29]](_0xa520[99],_0x7975x4e,_0xa520[100],_0x7975x4f,_0xa520[101])});_0x7975x4d[_0xa520[96]](_0xa520[102],()=>{console[_0xa520[29]](_0xa520[103]);opc_server[0][_0xa520[23]][4][_0xa520[22]]= 0});_0x7975x4d[_0xa520[96]](_0xa520[104],()=>{console[_0xa520[29]](_0xa520[105]);readOPCUA1()});_0x7975x4d[_0xa520[96]](_0xa520[106],()=>{console[_0xa520[29]](_0xa520[107]);opc_server[0][_0xa520[23]][4][_0xa520[22]]= 0});_0x7975x4d[_0xa520[96]](_0xa520[108],()=>{console[_0xa520[29]](_0xa520[109])});_0x7975x4d[_0xa520[96]](_0xa520[110],(_0x7975x41)=>{console[_0xa520[29]](_0xa520[111],_0x7975x41)}); await _0x7975x4d[_0xa520[11]](process[_0xa520[10]].FLEXY_URL);const _0x7975x50= await _0x7975x4d[_0xa520[114]]({userName:opc_server[0][_0xa520[112]],password:opc_server[0][_0xa520[113]]});const _0x7975x51= await _0x7975x50[_0xa520[115]]({maxNotificationsPerPublish:5000,publishingEnabled:true,requestedLifetimeCount:500,requestedMaxKeepAliveCount:50,requestedPublishingInterval:5000});_0x7975x51[_0xa520[96]](_0xa520[116],(_0x7975x52)=>{});const _0x7975x53=[];opc_server[0][_0xa520[23]][_0xa520[53]](function(_0x7975x54){let _0x7975x55=_0xa520[117]+ flexy_ns+ _0xa520[118]+ _0x7975x54[_0xa520[119]];let _0x7975x56={attributeId:AttributeIds[_0xa520[120]],nodeId:resolveNodeId(_0x7975x55)};_0x7975x53[_0xa520[67]](_0x7975x56)});const _0x7975x57={discardOldest:true,queueSize:1,samplingInterval:10};const _0x7975x58=ClientMonitoredItemGroup[_0xa520[97]](_0x7975x51,_0x7975x53,_0x7975x57,TimestampsToReturn.Both);_0x7975x58[_0xa520[96]](_0xa520[121],()=>{console[_0xa520[29]](_0xa520[122]);opc_server[0][_0xa520[23]][4][_0xa520[22]]= 1});_0x7975x58[_0xa520[96]](_0xa520[123],(_0x7975x59,_0x7975x5a,_0x7975x5b)=>{let _0x7975x5c=_0x7975x59[_0xa520[125]][_0xa520[124]][_0xa520[22]];let _0x7975x5d=_0x7975x5a[_0xa520[126]].toString();var _0x7975x5e=opc_server[0][_0xa520[23]][_0xa520[127]](function(_0x7975x5f,_0x7975x60){return _0x7975x5f[_0xa520[119]]=== _0x7975x5c});opc_server[0][_0xa520[23]][_0x7975x5e][_0xa520[22]]= parseFloat(_0x7975x5a[_0xa520[22]][_0xa520[22]][_0xa520[128]](2));opc_server[0][_0xa520[23]][_0x7975x5e][_0xa520[129]]=  new Date(_0x7975x5d);opc_server[0][_0xa520[38]]=  new Date(_0x7975x5d);opc_server[0][_0xa520[23]][4][_0xa520[22]]= 1;interval_flag= 1}); await  new Promise((_0x7975x61)=>setTimeout(_0x7975x61,1000000000)); await _0x7975x58[_0xa520[130]](); await _0x7975x50[_0xa520[131]](); await _0x7975x4d[_0xa520[132]]();console[_0xa520[29]](_0xa520[133]);readOPCUA1()}catch(err){console[_0xa520[29]](_0xa520[134],err)}}function exportToCSVFile(_0x7975x14){const _0x7975x4c={fieldSeparator:_0xa520[135],quoteStrings:_0xa520[136],decimalSeparator:_0xa520[137],showLabels:true,showTitle:true,title:_0xa520[138],useTextFile:false,useBom:true,useKeysAsHeaders:false,headers:[_0xa520[139],_0xa520[140],_0xa520[120]]};const _0x7975x63= new ExportToCsv(_0x7975x4c);const _0x7975x64=_0x7975x63[_0xa520[141]](_0x7975x14,true);var _0x7975x65= new Date();_0x7975x65= moment(_0x7975x65)[_0xa520[42]](_0xa520[142]);let _0x7975x66=process[_0xa520[10]][_0xa520[143]]+ _0xa520[144]+ process[_0xa520[10]][_0xa520[17]]+ _0xa520[145]+ _0x7975x65+ _0xa520[146];fs[_0xa520[31]](_0x7975x66,_0x7975x64)}