var _0x80bd=["\x63\x6F\x6E\x66\x69\x67","\x64\x6F\x74\x65\x6E\x76","\x6D\x6F\x6D\x65\x6E\x74","\x6D\x6F\x6E\x67\x6F\x6F\x73\x65","\x6D\x73\x73\x71\x6C","\x2E\x2F\x6D\x6F\x64\x65\x6C\x73\x2F\x72\x61\x77\x64\x61\x74\x61\x2E\x6D\x6F\x64\x65\x6C","\x2E\x2F\x6D\x6F\x64\x65\x6C\x73\x2F\x63\x61\x6C\x63\x64\x61\x74\x61\x2E\x6D\x6F\x64\x65\x6C","\x65\x6E\x76","\x63\x6F\x6E\x6E\x65\x63\x74","\x75\x73\x65\x46\x69\x6E\x64\x41\x6E\x64\x4D\x6F\x64\x69\x66\x79","\x73\x65\x74","\x2E\x2F\x63\x6F\x6E\x66\x69\x67\x2F\x73\x71\x6C\x2E\x6A\x73","\x6E\x6F\x64\x65\x2D\x6F\x70\x63\x75\x61\x2D\x63\x6C\x69\x65\x6E\x74","\x46\x4C\x45\x58\x59\x5F\x4E\x61\x6D\x65\x73\x70\x61\x63\x65","\x76\x61\x6C\x75\x65","\x64\x61\x74\x61","\x74\x69\x65\x72\x31","\x74\x69\x65\x72\x32","\x73\x69\x74\x65\x5F\x69\x64","\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65","\x73\x74\x72\x69\x6E\x67\x69\x66\x79","\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74","\x45\x72\x72\x6F\x72\x20\x73\x61\x76\x65\x20\x64\x61\x74\x61\x20\x74\x6F\x20\x4C\x6F\x63\x61\x6C\x20\x64\x61\x74\x61","\x6C\x6F\x67","\x69\x6E\x73\x65\x72\x74\x4D\x61\x6E\x79","\x6D\x69\x6E\x75\x74\x65\x73","\x73\x75\x62\x74\x72\x61\x63\x74","\x66\x69\x6E\x64","\x63\x6F\x75\x6E\x74\x44\x6F\x63\x75\x6D\x65\x6E\x74\x73","\x69\x6E\x66\x6F\x72\x6D\x61\x74\x69\x6F\x6E","\x66\x6F\x72\x45\x61\x63\x68","\x61\x76\x72\x46\x6C\x6F\x77","\x61\x76\x72\x5F\x66\x6C\x6F\x77","\x64\x61\x79\x73","\x64\x65\x6C\x65\x74\x65\x4D\x61\x6E\x79","\x44\x65\x6C\x65\x74\x65\x64\x20\x64\x61\x74\x61\x20\x62\x65\x66\x6F\x72\x65\x20","\x54\x6F\x74\x61\x6C\x20\x72\x65\x63\x6F\x72\x64\x20\x64\x65\x6C\x65\x74\x65\x64\x20\x3D\x20","\x64\x65\x6C\x65\x74\x65\x64\x43\x6F\x75\x6E\x74","\x46\x4C\x45\x58\x59\x5F\x54\x61\x67\x6E\x61\x6D\x65\x31","\x46\x4C\x45\x58\x59\x5F\x54\x61\x67\x6E\x61\x6D\x65\x32","\x46\x4C\x45\x58\x59\x5F\x54\x61\x67\x6E\x61\x6D\x65\x33","\x46\x4C\x45\x58\x59\x5F\x54\x61\x67\x6E\x61\x6D\x65\x34","\x46\x4C\x45\x58\x59\x5F\x54\x61\x67\x6E\x61\x6D\x65\x35","\x66\x6F\x72\x6D\x61\x74","\x6C\x6F\x63\x61\x6C","\x70\x75\x73\x68","\x69\x70","\x70\x6F\x72\x74","\x4F\x50\x43\x5F\x53\x45\x52\x56\x45\x52\x5F\x55\x53\x45\x52\x4E\x41\x4D\x45","\x4F\x50\x43\x5F\x53\x45\x52\x56\x45\x52\x5F\x50\x41\x53\x53\x57\x4F\x52\x44","\x6C\x69\x6D\x69\x74","\x73\x6F\x72\x74","\x66\x69\x6E\x64\x4F\x6E\x65","\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A\x2A","\x46\x69\x72\x73\x74\x20\x69\x6E\x69\x74\x69\x61\x6C\x69\x7A\x65\x20","\x69\x6E\x70\x75\x74","\x74\x65\x6D\x70\x65\x72\x61\x74\x75\x72\x65","\x70\x72\x65\x73\x73\x75\x72\x65","\x66\x6C\x6F\x77","\x63\x6F\x6D\x70\x65\x6E\x73\x61\x74\x65\x64\x66\x6C\x6F\x77","\x49\x4E\x53\x45\x52\x54\x20\x49\x4E\x54\x4F\x20\x44\x61\x74\x61\x4C\x6F\x67\x67\x65\x72\x31\x20\x28\x73\x69\x74\x65\x5F\x69\x64\x2C\x20\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65\x2C\x20\x74\x65\x6D\x70\x65\x72\x61\x74\x75\x72\x65\x2C\x20\x70\x72\x65\x73\x73\x75\x72\x65\x2C\x20\x66\x6C\x6F\x77\x2C\x20\x63\x6F\x6D\x70\x65\x6E\x73\x61\x74\x65\x64\x66\x6C\x6F\x77\x2C","\x20\x69\x6E\x66\x6F\x72\x6D\x61\x74\x69\x6F\x6E\x2C\x20\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x2C\x20\x74\x69\x65\x72\x31\x2C\x20\x74\x69\x65\x72\x32\x29\x20\x56\x41\x4C\x55\x45\x53\x20","\x20\x28\x40\x73\x69\x74\x65\x5F\x69\x64\x2C\x40\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65\x2C\x20\x40\x74\x65\x6D\x70\x65\x72\x61\x74\x75\x72\x65\x2C\x40\x70\x72\x65\x73\x73\x75\x72\x65\x2C\x20\x40\x66\x6C\x6F\x77\x2C\x20\x40\x63\x6F\x6D\x70\x65\x6E\x73\x61\x74\x65\x64\x66\x6C\x6F\x77\x2C\x20\x40\x69\x6E\x66\x6F\x72\x6D\x61\x74\x69\x6F\x6E\x2C\x20\x40\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x2C\x20\x40\x74\x69\x65\x72\x31\x2C\x20\x40\x74\x69\x65\x72\x32\x29","\x71\x75\x65\x72\x79","\x49\x4E\x53\x45\x52\x54\x20\x49\x4E\x54\x4F\x20\x44\x61\x74\x61\x4C\x6F\x67\x67\x65\x72\x32\x20\x28\x73\x69\x74\x65\x5F\x69\x64\x2C\x20\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65\x2C\x20\x61\x76\x72\x66\x6C\x6F\x77\x2C\x20\x74\x69\x65\x72\x31\x2C\x20\x74\x69\x65\x72\x32\x2C\x20\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x29\x20\x56\x41\x4C\x55\x45\x53\x20\x28\x40\x73\x69\x74\x65\x5F\x69\x64\x2C\x40\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65\x2C\x20\x40\x61\x76\x72\x46\x6C\x6F\x77\x2C\x20\x40\x74\x69\x65\x72\x31\x2C\x20\x40\x74\x69\x65\x72\x32\x2C\x20\x40\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x29","\x69\x73\x5F\x63\x6F\x6E\x6E\x65\x63\x74","\x49\x4E\x53\x45\x52\x54\x20\x49\x4E\x54\x4F\x20\x44\x61\x74\x61\x4C\x6F\x67\x67\x65\x72\x53\x74\x61\x74\x75\x73\x20\x28\x73\x69\x74\x65\x5F\x69\x64\x2C\x20\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65\x2C\x20\x69\x73\x5F\x63\x6F\x6E\x6E\x65\x63\x74\x2C\x20\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x29\x20\x56\x41\x4C\x55\x45\x53\x20\x28\x40\x73\x69\x74\x65\x5F\x69\x64\x2C\x40\x73\x69\x74\x65\x5F\x6E\x61\x6D\x65\x2C\x20\x40\x69\x73\x5F\x63\x6F\x6E\x6E\x65\x63\x74\x2C\x20\x40\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x29","\x62\x65\x66\x6F\x72\x65\x64\x61\x79","\x44\x45\x4C\x45\x54\x45\x20\x46\x52\x4F\x4D\x20\x44\x61\x74\x61\x4C\x6F\x67\x67\x65\x72\x31\x20\x57\x48\x45\x52\x45\x20\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x20\x3C\x20\x40\x62\x65\x66\x6F\x72\x65\x64\x61\x79","\x44\x45\x4C\x45\x54\x45\x20\x46\x52\x4F\x4D\x20\x44\x61\x74\x61\x4C\x6F\x67\x67\x65\x72\x32\x20\x57\x48\x45\x52\x45\x20\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x20\x3C\x20\x40\x62\x65\x66\x6F\x72\x65\x64\x61\x79","\x44\x45\x4C\x45\x54\x45\x20\x46\x52\x4F\x4D\x20\x44\x61\x74\x61\x4C\x6F\x67\x67\x65\x72\x53\x74\x61\x74\x75\x73\x20\x57\x48\x45\x52\x45\x20\x63\x72\x65\x61\x74\x65\x64\x5F\x61\x74\x20\x3C\x20\x40\x62\x65\x66\x6F\x72\x65\x64\x61\x79","\x44\x65\x6C\x65\x74\x65\x64\x20\x64\x61\x74\x61\x20\x62\x65\x66\x6F\x72\x65\x20\x31\x30\x20\x64\x61\x79\x73","\x65\x72\x72\x6F\x72","\x53\x51\x4C\x20\x68\x61\x73\x20\x69\x73\x73\x75\x65\x20","\x6F\x6E","\x63\x72\x65\x61\x74\x65","\x62\x61\x63\x6B\x6F\x66\x66","\x42\x61\x63\x6B\x6F\x66\x66\x20","\x20\x6E\x65\x78\x74\x20\x61\x74\x74\x65\x6D\x70\x74\x20\x69\x6E\x20","\x6D\x73","\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x5F\x6C\x6F\x73\x74","\x43\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x20\x6C\x6F\x73\x74","\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x5F\x72\x65\x65\x73\x74\x61\x62\x6C\x69\x73\x68\x65\x64","\x43\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x20\x72\x65\x2D\x65\x73\x74\x61\x62\x6C\x69\x73\x68\x65\x64","\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x5F\x66\x61\x69\x6C\x65\x64","\x43\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x20\x66\x61\x69\x6C\x65\x64","\x73\x74\x61\x72\x74\x5F\x72\x65\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E","\x53\x74\x61\x72\x74\x69\x6E\x67\x20\x72\x65\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E","\x61\x66\x74\x65\x72\x5F\x72\x65\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E","\x41\x66\x74\x65\x72\x20\x52\x65\x63\x6F\x6E\x6E\x65\x63\x74\x69\x6F\x6E\x20\x65\x76\x65\x6E\x74\x20\x3D\x3E","\x75\x73\x65\x72\x6E\x61\x6D\x65","\x70\x61\x73\x73\x77\x6F\x72\x64","\x63\x72\x65\x61\x74\x65\x53\x65\x73\x73\x69\x6F\x6E","\x63\x72\x65\x61\x74\x65\x53\x75\x62\x73\x63\x72\x69\x70\x74\x69\x6F\x6E\x32","\x73\x74\x61\x72\x74\x65\x64","\x6E\x73\x3D","\x3B\x73\x3D","\x6E\x61\x6D\x65","\x56\x61\x6C\x75\x65","\x69\x6E\x69\x74\x69\x61\x6C\x69\x7A\x65\x64","\x4F\x50\x43\x20\x55\x41\x20\x49\x6E\x69\x74\x69\x61\x6C\x69\x7A\x65\x64\x21\x20\x43\x6F\x6E\x6E\x65\x63\x74\x20\x74\x6F\x20\x46\x6C\x65\x78\x79\x20\x73\x75\x63\x63\x65\x73\x73\x66\x75\x6C\x6C\x79","\x63\x68\x61\x6E\x67\x65\x64","\x6E\x6F\x64\x65\x49\x64","\x69\x74\x65\x6D\x54\x6F\x4D\x6F\x6E\x69\x74\x6F\x72","\x73\x65\x72\x76\x65\x72\x54\x69\x6D\x65\x73\x74\x61\x6D\x70","\x66\x69\x6E\x64\x49\x6E\x64\x65\x78","\x74\x6F\x46\x69\x78\x65\x64","\x74\x69\x6D\x65","\x74\x65\x72\x6D\x69\x6E\x61\x74\x65","\x63\x6C\x6F\x73\x65","\x64\x69\x73\x63\x6F\x6E\x6E\x65\x63\x74","\x44\x6F\x6E\x65\x20\x21","\x45\x72\x72\x6F\x72"];require(_0x80bd[1])[_0x80bd[0]]();var moment=require(_0x80bd[2]);var mongoose=require(_0x80bd[3]);var sql=require(_0x80bd[4]);var RawData=require(_0x80bd[5]);var CalcData=require(_0x80bd[6]);mongoose[_0x80bd[8]](process[_0x80bd[7]].MONGO_URL,{useNewUrlParser:true,useUnifiedTopology:true});mongoose[_0x80bd[10]](_0x80bd[9],false);const sqlConfig=require(_0x80bd[11]);const {OPCUAClient,resolveNodeId,AttributeIds,ClientMonitoredItemGroup,TimestampsToReturn}=require(_0x80bd[12]);let TIER_2_BENCHMARK=parseFloat(process[_0x80bd[7]].TIER_2_BENCHMARK);let TIME_INTERVAL_GETDATA=parseInt(process[_0x80bd[7]].TIME_INTERVAL_GETDATA)* 1000;let TIME_INTERVAL_CALCDATA=parseInt(process[_0x80bd[7]].TIME_INTERVAL_CALCDATA)* 1000;let TIME_INTERVAL_REMOVE_DATA=parseInt(process[_0x80bd[7]].TIME_INTERVAL_REMOVE_DATA)* 86400000;let flexy_ns=process[_0x80bd[7]][_0x80bd[13]];var opc_server=[];var opc_server_avr=[];var interval_flag=0;async function run(){ await readFirstConfig(); await setTimeout(function(){},2000); await setInterval(async function(){if(interval_flag){let _0x68ffx10=opc_server[0][_0x80bd[15]][3][_0x80bd[14]];let _0x68ffx11=opc_server[0][_0x80bd[16]];let _0x68ffx12=opc_server[0][_0x80bd[17]];let _0x68ffx13,_0x68ffx14;if(_0x68ffx10> TIER_2_BENCHMARK){_0x68ffx13= TIER_2_BENCHMARK/ 60+ _0x68ffx11;_0x68ffx14= (_0x68ffx10- TIER_2_BENCHMARK)/ 60+ _0x68ffx12}else {_0x68ffx13= _0x68ffx10/ 60+ _0x68ffx11;_0x68ffx14= 0+ _0x68ffx12};opc_server[0][_0x80bd[16]]= _0x68ffx13;opc_server[0][_0x80bd[17]]= _0x68ffx14;let _0x68ffx15=opc_server[0][_0x80bd[18]];let _0x68ffx16=opc_server[0][_0x80bd[19]];insert_data(_0x68ffx15,_0x68ffx16,opc_server[0][_0x80bd[15]][0][_0x80bd[14]],opc_server[0][_0x80bd[15]][2][_0x80bd[14]],opc_server[0][_0x80bd[15]][1][_0x80bd[14]],opc_server[0][_0x80bd[15]][3][_0x80bd[14]],JSON[_0x80bd[20]](opc_server[0][_0x80bd[15]]),_0x68ffx13,_0x68ffx14,opc_server[0][_0x80bd[21]]);saveConnectionStatusToDatabase(opc_server[0][_0x80bd[18]],opc_server[0][_0x80bd[19]],opc_server[0][_0x80bd[15]][4][_0x80bd[14]]);let _0x68ffx17={site_id:opc_server[0][_0x80bd[18]],site_name:opc_server[0][_0x80bd[19]],information:opc_server[0][_0x80bd[15]],tier1:opc_server[0][_0x80bd[16]],tier2:opc_server[0][_0x80bd[17]],created_at: new Date()}; await RawData[_0x80bd[24]](_0x68ffx17,function(_0x68ffx18,_0x68ffx19){if(_0x68ffx18){console[_0x80bd[23]](_0x80bd[22])}})}},TIME_INTERVAL_GETDATA); await setInterval(async function(){if(interval_flag){let _0x68ffx1a=moment()[_0x80bd[26]](15,_0x80bd[25]);let _0x68ffx1b=moment();let _0x68ffx1c={created_at:{$gte:_0x68ffx1a,$lte:_0x68ffx1b},tier1:{$gt:0}};let _0x68ffx1d= await RawData[_0x80bd[27]](_0x68ffx1c);let _0x68ffx1e= await RawData[_0x80bd[28]](_0x68ffx1c);let _0x68ffx1f=0;_0x68ffx1d[_0x80bd[30]](function(_0x68ffx20){_0x68ffx1f= _0x68ffx1f+ parseFloat(_0x68ffx20[_0x80bd[29]][3][_0x80bd[14]])});let _0x68ffx21=0;if(_0x68ffx1e> 0){_0x68ffx21= _0x68ffx1f/ _0x68ffx1e};let _0x68ffx22=opc_server_avr[_0x80bd[16]];let _0x68ffx23=opc_server_avr[_0x80bd[17]];let _0x68ffx24,_0x68ffx25;if(_0x68ffx21> TIER_2_BENCHMARK){_0x68ffx24= TIER_2_BENCHMARK/ 60+ _0x68ffx22;_0x68ffx25= (_0x68ffx21- TIER_2_BENCHMARK)/ 60+ _0x68ffx23}else {_0x68ffx24= _0x68ffx21/ 60+ _0x68ffx22;_0x68ffx25= 0+ _0x68ffx23};opc_server_avr[_0x80bd[16]]= _0x68ffx24;opc_server_avr[_0x80bd[17]]= _0x68ffx25;opc_server_avr[_0x80bd[21]]=  new Date();opc_server_avr[_0x80bd[31]]= _0x68ffx21;let _0x68ffx26=opc_server_avr;_0x68ffx26[_0x80bd[32]]= opc_server_avr[_0x80bd[31]];CalcData[_0x80bd[24]](_0x68ffx26,function(_0x68ffx18,_0x68ffx19){if(_0x68ffx18){console[_0x80bd[23]](_0x80bd[22])}});saveAvrDataToDatabase(opc_server[0][_0x80bd[18]],opc_server[0][_0x80bd[19]],opc_server_avr[_0x80bd[31]],opc_server_avr[_0x80bd[16]],opc_server_avr[_0x80bd[17]])}},TIME_INTERVAL_CALCDATA); await setInterval(async function(){let _0x68ffx27=moment()[_0x80bd[26]](10,_0x80bd[33]);const _0x68ffx28= await RawData[_0x80bd[34]]({created_at:{$lte:_0x68ffx27}});console[_0x80bd[23]](_0x80bd[35],_0x68ffx27,_0x80bd[36],_0x68ffx28[_0x80bd[37]]);deleteDataAfter10days()},TIME_INTERVAL_REMOVE_DATA); await readOPCUA1()}run();async function readFirstConfig(){let _0x68ffx2a=[];let _0x68ffx2b=[process[_0x80bd[7]][_0x80bd[38]],process[_0x80bd[7]][_0x80bd[39]],process[_0x80bd[7]][_0x80bd[40]],process[_0x80bd[7]][_0x80bd[41]],process[_0x80bd[7]][_0x80bd[42]]];for(const _0x68ffx2c of _0x68ffx2b){_0x68ffx2a[_0x80bd[45]]({name:_0x68ffx2c,value:0,time:moment()[_0x80bd[44]]()[_0x80bd[43]]()})};let _0x68ffx2d={id:1,site_id:process[_0x80bd[7]][_0x80bd[18]],site_name:process[_0x80bd[7]][_0x80bd[19]],ip:process[_0x80bd[7]][_0x80bd[46]],port:parseInt(process[_0x80bd[7]][_0x80bd[47]]),username:process[_0x80bd[7]][_0x80bd[48]],password:process[_0x80bd[7]][_0x80bd[49]],data:_0x68ffx2a,tier1:0,tier2:0,created_at: new Date()};opc_server_avr= {avrFlow:0,tier1:0,tier2:0};let _0x68ffx2e= await RawData[_0x80bd[52]]()[_0x80bd[51]]({_id:-1})[_0x80bd[50]](1);if(_0x68ffx2e){_0x68ffx2d[_0x80bd[16]]= _0x68ffx2e[_0x80bd[16]];_0x68ffx2d[_0x80bd[17]]= _0x68ffx2e[_0x80bd[17]]}else {_0x68ffx2d[_0x80bd[16]]= parseFloat(process[_0x80bd[7]].START_TIER_1);_0x68ffx2d[_0x80bd[17]]= parseFloat(process[_0x80bd[7]].START_TIER_2)};let _0x68ffx2f= await CalcData[_0x80bd[52]]()[_0x80bd[51]]({_id:-1})[_0x80bd[50]](1);if(_0x68ffx2f){opc_server_avr[_0x80bd[16]]= _0x68ffx2f[_0x80bd[16]];opc_server_avr[_0x80bd[17]]= _0x68ffx2f[_0x80bd[17]]}else {opc_server_avr[_0x80bd[16]]= parseFloat(process[_0x80bd[7]].START_AVR_TIER_1);opc_server_avr[_0x80bd[17]]= parseFloat(process[_0x80bd[7]].START_AVR_TIER_2)};opc_server[_0x80bd[45]](_0x68ffx2d);console[_0x80bd[23]](_0x80bd[53]);console[_0x80bd[23]](_0x80bd[54],opc_server,opc_server_avr);return}function insert_data(_0x68ffx31,_0x68ffx32,_0x68ffx33,_0x68ffx34,_0x68ffx35,_0x68ffx36,_0x68ffx37,_0x68ffx13,_0x68ffx14,_0x68ffx38){sql[_0x80bd[8]](sqlConfig,function(_0x68ffx39){if(_0x68ffx39){console[_0x80bd[23]](_0x68ffx39)}else {var _0x68ffx3a= new sql.Request();_0x68ffx3a[_0x80bd[55]](_0x80bd[18],sql.VarChar,_0x68ffx31);_0x68ffx3a[_0x80bd[55]](_0x80bd[19],sql.VarChar,_0x68ffx32);_0x68ffx3a[_0x80bd[55]](_0x80bd[29],sql.VarChar,_0x68ffx37);_0x68ffx3a[_0x80bd[55]](_0x80bd[21],sql.DateTimeOffset,_0x68ffx38);_0x68ffx3a[_0x80bd[55]](_0x80bd[56],sql.Decimal(10,2),parseFloat(_0x68ffx33+ 0.0));_0x68ffx3a[_0x80bd[55]](_0x80bd[57],sql.Decimal(10,2),parseFloat(_0x68ffx34+ 0.0));_0x68ffx3a[_0x80bd[55]](_0x80bd[58],sql.Decimal(10,2),parseFloat(_0x68ffx35+ 0.0));_0x68ffx3a[_0x80bd[55]](_0x80bd[59],sql.Decimal(10,2),parseFloat(_0x68ffx36+ 0.0));_0x68ffx3a[_0x80bd[55]](_0x80bd[16],sql.Decimal(10,2),parseFloat(_0x68ffx13));_0x68ffx3a[_0x80bd[55]](_0x80bd[17],sql.Decimal(10,2),parseFloat(_0x68ffx14));let _0x68ffx3b=_0x80bd[60]+ _0x80bd[61]+ _0x80bd[62];_0x68ffx3a[_0x80bd[63]](_0x68ffx3b,function(_0x68ffx39,_0x68ffx3c){if(_0x68ffx39){console[_0x80bd[23]](_0x68ffx39)}})}})}function saveAvrDataToDatabase(_0x68ffx31,_0x68ffx32,_0x68ffx3e,_0x68ffx13,_0x68ffx14){sql[_0x80bd[8]](sqlConfig,function(_0x68ffx39){if(_0x68ffx39){console[_0x80bd[23]](_0x68ffx39)}else {var _0x68ffx3a= new sql.Request();_0x68ffx3a[_0x80bd[55]](_0x80bd[18],sql.VarChar,_0x68ffx31);_0x68ffx3a[_0x80bd[55]](_0x80bd[19],sql.VarChar,_0x68ffx32);_0x68ffx3a[_0x80bd[55]](_0x80bd[31],sql.Decimal(10,2),parseFloat(_0x68ffx3e));_0x68ffx3a[_0x80bd[55]](_0x80bd[16],sql.Decimal(10,2),parseFloat(_0x68ffx13));_0x68ffx3a[_0x80bd[55]](_0x80bd[17],sql.Decimal(10,2),parseFloat(_0x68ffx14));_0x68ffx3a[_0x80bd[55]](_0x80bd[21],sql.DateTimeOffset, new Date());_0x68ffx3a[_0x80bd[63]](_0x80bd[64],function(_0x68ffx39,_0x68ffx3c){if(_0x68ffx39){console[_0x80bd[23]](_0x68ffx39)}})}})}function saveConnectionStatusToDatabase(_0x68ffx31,_0x68ffx32,_0x68ffx40){sql[_0x80bd[8]](sqlConfig,function(_0x68ffx39){if(_0x68ffx39){console[_0x80bd[23]](_0x68ffx39)}else {var _0x68ffx3a= new sql.Request();_0x68ffx3a[_0x80bd[55]](_0x80bd[18],sql.VarChar,_0x68ffx31);_0x68ffx3a[_0x80bd[55]](_0x80bd[19],sql.VarChar,_0x68ffx32);_0x68ffx3a[_0x80bd[55]](_0x80bd[65],sql.Bit,_0x68ffx40);_0x68ffx3a[_0x80bd[55]](_0x80bd[21],sql.DateTimeOffset, new Date());_0x68ffx3a[_0x80bd[63]](_0x80bd[66],function(_0x68ffx39,_0x68ffx3c){if(_0x68ffx39){console[_0x80bd[23]](_0x68ffx39)}})}})}function deleteDataAfter10days(){sql[_0x80bd[8]](sqlConfig,function(_0x68ffx39){if(_0x68ffx39){console[_0x80bd[23]](_0x68ffx39)}else {var _0x68ffx3a= new sql.Request();let _0x68ffx27=moment()[_0x80bd[26]](10,_0x80bd[33]);let _0x68ffx42= new Date(_0x68ffx27);_0x68ffx3a[_0x80bd[55]](_0x80bd[67],sql.DateTimeOffset,_0x68ffx42);_0x68ffx3a[_0x80bd[63]](_0x80bd[68],function(_0x68ffx39,_0x68ffx3c){if(_0x68ffx39){console[_0x80bd[23]](_0x68ffx39)}});_0x68ffx3a[_0x80bd[63]](_0x80bd[69],function(_0x68ffx39,_0x68ffx3c){if(_0x68ffx39){console[_0x80bd[23]](_0x68ffx39)}});_0x68ffx3a[_0x80bd[63]](_0x80bd[70],function(_0x68ffx39,_0x68ffx3c){if(_0x68ffx39){console[_0x80bd[23]](_0x68ffx39)};console[_0x80bd[23]](_0x80bd[71])})}});sql[_0x80bd[74]](_0x80bd[72],(_0x68ffx39)=>{console[_0x80bd[23]](_0x80bd[73],_0x68ffx39)})}async function readOPCUA1(){try{const _0x68ffx44={endpoint_must_exist:false};const _0x68ffx45=OPCUAClient[_0x80bd[75]](_0x68ffx44);_0x68ffx45[_0x80bd[74]](_0x80bd[76],(_0x68ffx46,_0x68ffx47)=>{console[_0x80bd[23]](_0x80bd[77],_0x68ffx46,_0x80bd[78],_0x68ffx47,_0x80bd[79])});_0x68ffx45[_0x80bd[74]](_0x80bd[80],()=>{console[_0x80bd[23]](_0x80bd[81]);opc_server[0][_0x80bd[15]][4][_0x80bd[14]]= 0});_0x68ffx45[_0x80bd[74]](_0x80bd[82],()=>{console[_0x80bd[23]](_0x80bd[83]);readOPCUA1()});_0x68ffx45[_0x80bd[74]](_0x80bd[84],()=>{console[_0x80bd[23]](_0x80bd[85]);opc_server[0][_0x80bd[15]][4][_0x80bd[14]]= 0});_0x68ffx45[_0x80bd[74]](_0x80bd[86],()=>{console[_0x80bd[23]](_0x80bd[87])});_0x68ffx45[_0x80bd[74]](_0x80bd[88],(_0x68ffx39)=>{console[_0x80bd[23]](_0x80bd[89],_0x68ffx39)}); await _0x68ffx45[_0x80bd[8]](process[_0x80bd[7]].FLEXY_URL);const _0x68ffx48= await _0x68ffx45[_0x80bd[92]]({userName:opc_server[0][_0x80bd[90]],password:opc_server[0][_0x80bd[91]]});const _0x68ffx49= await _0x68ffx48[_0x80bd[93]]({maxNotificationsPerPublish:5000,publishingEnabled:true,requestedLifetimeCount:500,requestedMaxKeepAliveCount:50,requestedPublishingInterval:5000});_0x68ffx49[_0x80bd[74]](_0x80bd[94],(_0x68ffx4a)=>{});const _0x68ffx4b=[];opc_server[0][_0x80bd[15]][_0x80bd[30]](function(_0x68ffx4c){let _0x68ffx4d=_0x80bd[95]+ flexy_ns+ _0x80bd[96]+ _0x68ffx4c[_0x80bd[97]];let _0x68ffx4e={attributeId:AttributeIds[_0x80bd[98]],nodeId:resolveNodeId(_0x68ffx4d)};_0x68ffx4b[_0x80bd[45]](_0x68ffx4e)});const _0x68ffx4f={discardOldest:true,queueSize:1,samplingInterval:10};const _0x68ffx50=ClientMonitoredItemGroup[_0x80bd[75]](_0x68ffx49,_0x68ffx4b,_0x68ffx4f,TimestampsToReturn.Both);_0x68ffx50[_0x80bd[74]](_0x80bd[99],()=>{console[_0x80bd[23]](_0x80bd[100]);opc_server[0][_0x80bd[15]][4][_0x80bd[14]]= 1});_0x68ffx50[_0x80bd[74]](_0x80bd[101],(_0x68ffx51,_0x68ffx52,_0x68ffx53)=>{let _0x68ffx54=_0x68ffx51[_0x80bd[103]][_0x80bd[102]][_0x80bd[14]];let _0x68ffx55=_0x68ffx52[_0x80bd[104]].toString();var _0x68ffx56=opc_server[0][_0x80bd[15]][_0x80bd[105]](function(_0x68ffx57,_0x68ffx58){return _0x68ffx57[_0x80bd[97]]=== _0x68ffx54});opc_server[0][_0x80bd[15]][_0x68ffx56][_0x80bd[14]]= parseFloat(_0x68ffx52[_0x80bd[14]][_0x80bd[14]][_0x80bd[106]](2));opc_server[0][_0x80bd[15]][_0x68ffx56][_0x80bd[107]]=  new Date(_0x68ffx55);opc_server[0][_0x80bd[21]]=  new Date(_0x68ffx55);opc_server[0][_0x80bd[15]][4][_0x80bd[14]]= 1;interval_flag= 1}); await  new Promise((_0x68ffx59)=>setTimeout(_0x68ffx59,1000000000)); await _0x68ffx50[_0x80bd[108]](); await _0x68ffx48[_0x80bd[109]](); await _0x68ffx45[_0x80bd[110]]();console[_0x80bd[23]](_0x80bd[111]);readOPCUA1()}catch(err){console[_0x80bd[23]](_0x80bd[112],err)}}